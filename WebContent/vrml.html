<!DOCTYPE html>
<html lang="en">
<head>
<title>vrml loader</title>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<style>
body {
	font-family: Monospace;
	background-color: #000;
	color: #fff;
	margin: 0px;
	overflow: hidden;
}

#info {
	color: #fff;
	position: absolute;
	top: 10px;
	width: 100%;
	text-align: center;
	z-index: 100;
	display: block;
}

#info a, .button {
	color: #f00;
	font-weight: bold;
	text-decoration: underline;
	cursor: pointer
}
</style>
</head>

<body>
	<script type="text/javascript" src="js/3d/three.min.js"></script>
	<script type="text/javascript" src="js/3d/OrbitControls.js"></script>
	<script type="text/javascript" src="js/3d/VRMLLoader.js"></script>
	<script>
    function GetRequest()
    {
    	var strHref = window.location.href;
    	var id = strHref.indexOf("#");
    	if (id > 0)
    		return strHref.substr(id + 1);
    	else
    		return "";
    }
	</script>
	<script>
		var container;

		var camera, controls, scene, renderer;

		var cross;

		init();
		animate();

		function init() {


		    var SCREEN_WIDTH = window.innerWidth,
		        SCREEN_HEIGHT = window.innerHeight;

		    // prepare camera
		    var VIEW_ANGLE = 45, ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 0.01, FAR = 20000;
		    camera = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR);
		    camera.position.set(-0.09, 0.05, -0.08);
		    camera.lookAt(new THREE.Vector3(0,0,0));
		    
// 			camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.01, 1e10);
// 			camera.position.z = 6;

			controls = new THREE.OrbitControls(camera);
			controls.target = new THREE.Vector3(0, 0, 0);
			controls.maxDistance = 3000;
			//controls.rotateSpeed = 5.0;
			//controls.zoomSpeed = 5;

			controls.noZoom = false;
			controls.noPan = false;

			scene = new THREE.Scene();
			scene.add(camera);
			scene.add( new THREE.AmbientLight(0x333333) );
			
			// light
			
			var dirLight = new THREE.DirectionalLight(0xffffff);
			
			dirLight.position.set(200, 200, 1000).normalize();

			camera.add(dirLight);
			camera.add(dirLight.target);

			var loader = new THREE.VRMLLoader();
			loader.load("/DataCenterBrowser/D3DServlet?D3Did=" + GetRequest(), function(object) {
				scene.add(object);
			});

			// renderer

			renderer = new THREE.WebGLRenderer({
				antialias : true
			});
			renderer.setPixelRatio(window.devicePixelRatio);
			renderer.setSize(window.innerWidth, window.innerHeight);
			renderer.shadowMapEnabled = true;
			renderer.shadowMapSoft = true;
			
			container = document.createElement('div');
			document.body.appendChild(container);
			container.appendChild(renderer.domElement);

			//

			window.addEventListener('resize', onWindowResize, false);

		}

		function onWindowResize() {

			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();

			renderer.setSize(window.innerWidth, window.innerHeight);

			controls.handleResize();

		}

		function animate() {

			requestAnimationFrame(animate);

			controls.update();
			renderer.render(scene, camera);


		}
	</script>

</body>
</html>
